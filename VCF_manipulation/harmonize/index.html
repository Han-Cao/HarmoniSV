<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://han-cao.github.io/HarmoniSV/VCF_manipulation/harmonize/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>harmonize - HarmoniSV</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "harmonize";
        var mkdocs_page_input_path = "VCF_manipulation/harmonize.md";
        var mkdocs_page_url = "/HarmoniSV/VCF_manipulation/harmonize/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> HarmoniSV
        </a>
        <div class="version">
          0.1.0
        </div><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../quick_start/">Quick start</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../tutorial/">Tutorial</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../command_list/">Command list</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">VCF manipulation</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">harmonize</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#input">Input</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#output">Output</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example-1-harmonize-sniffles2-ver-206-output">Example 1: Harmonize sniffles2 (ver 2.0.6) output</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#arguments">Arguments</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#required-arguments">Required arguments</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#optional-arguments">Optional arguments</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="" href="../harmonize_header.md">harmonize-header</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../sample2pop.md">sample2pop</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../intersect.md">intersect</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SV analysis</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../SV_analysis/represent.md">represent</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../SV_analysis/genotype.md">genotype</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../SV_analysis/filter.md">filter</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../SV_analysis/concordance.md">concordance</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">HarmoniSV</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>VCF manipulation &raquo;</li>
      <li>harmonize</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/Han-Cao/HarmoniSV/docs/VCF_manipulation/harmonize.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="harmonize"><em>harmonize</em></h1>
<p>Harmonize SV VCFs across samples and SV calling methods</p>
<p><strong><em> Last updated: 2023-03-19 </em></strong></p>
<h2 id="input">Input</h2>
<ul>
<li><strong>VCF</strong>: any VCF/BCF files following the VCF specification.</li>
<li><strong>ID format</strong>: no requirements</li>
</ul>
<h2 id="output">Output</h2>
<ul>
<li><strong>VCF</strong>: VCF/BCF files following the VCF specification.</li>
<li><strong>ID format</strong>: <code>{PREFIX}.{SVTYPE}.{NUMBER}</code> if <code>--rename-id --id-prefix PREFIX</code> is specified, otherwise the same as input.</li>
<li></li>
</ul>
<h2 id="usage">Usage</h2>
<pre><code class="language-bash">harmonisv harmonize [options] -i &lt;input_vcf&gt; -o &lt;output_vcf&gt; 
</code></pre>
<h2 id="examples">Examples</h2>
<h6 id="example-1-harmonize-sniffles2-ver-206-output">Example 1: Harmonize sniffles2 (ver 2.0.6) output</h6>
<p>Output VCF of <code>Sniffles2</code> store SV information (e.g., SVTYPE, SVLEN) in the INFO field, and the read depth of reference (DR) and variant (DV) alleles in the FORMAT field. The following command keep basic SV information and extract read depths to INFO fields.</p>
<pre><code class="language-bash">harmonisv harmonize \
-i input.vcf.gz \                           # input VCF
-o output.vcf.gz \                          # output VCF
--info SVTYPE,SVLEN,END,STRANDS=STRAND \    # INFO fields to be kept, rename STRAND to STRANDS
--format-to-info DP=DR,DP=DV,RE=DV \        # Extract FORMAT fields to INFO fields
--sum \                                     # Sum all values assigned to the same key (DP = DR + DV)
--header header.txt \                       # New VCF header, please define new keys here (i.e., DP, RE)
--rename-id \                               # rename ID to {PREFIX}.{SVTYPE}.{NUMBER}
--id-prefix HG002.minimap2.sniffles2        # {SAMPLE}.{ALIGNER}.{CALLER}
</code></pre>
<h2 id="arguments">Arguments</h2>
<h5 id="required-arguments">Required arguments</h5>
<dl>
<dt>-i, --invcf <em>vcf</em></dt>
<dd>input vcf</dd>
<dt>-o, --outvcf <em>vcf</em></dt>
<dd>output vcf</dd>
</dl>
<h5 id="optional-arguments">Optional arguments</h5>
<dl>
<dt>--info TAG</dt>
<dd>Comma separated INFO tags to extract, can rename tag by NEW=OLD. Can give multiple candidate old tags for 1 new tag, priority from high to low. E.g., 'NEW=OLD1,NEW=OLD2' means if OLD1 is present, use OLD1, otherwise use OLD2.</dd>
<dt>--info-to-alt TAG</dt>
<dd>Comma separated INFO tags to fill in ALT, from high prioirty to low priority. This is useful for insertion sequence stored in INFO.</dd>
<dt>--format-to-info TAG</dt>
<dd>Comma separated FORMAT tags to be sum and add in INFO, from high prioirty to low priority. New headers must given by --header.</dd>
<dt>--sum</dt>
<dd>Change merge logic to sum, all tags must exist for all records. E.g., '--format-to-info DP=DR,DP=DV --sum' means 'INFO/DP = sum(FORMAT/DR + FORMAT/DV)'</dd>
<dt>--header FILE</dt>
<dd>New vcf header file to replace the header of invcf</dd>
<dt>--header-str string</dt>
<dd>Semicolon separated INFO header string added to new header (metadata separated by comma). e.g., 'DP,1,Integar,Sequencing depth;AF,1,Float,Allele frequency'</dd>
<dt>--id-prefix PREFIX</dt>
<dd>Rename SV ID to PREFIX.raw_ID. Final ID should be Sample.Aligner.Caller.unique_id for downstream analysis</dd>
<dt>--rename-id</dt>
<dd>Rename SV ID to PREFIX.SVTYPE.No., must use with --id-prefix</dd>
<dt>--keep-old</dt>
<dd>Keep raw INFO when rename, useful when merging (default: False)</dd>
<dt>--keep-all</dt>
<dd>Whether keep all INFO fields. If specified, only rename work in --info (default: False)</dd>
<dt>--no-AC</dt>
<dd>Disable automatically add AC to INFO (default: False)</dd>
<dt>--no-check</dt>
<dd>Disable vcf check and filter on ID, SVTYPE for downstream analysis (default: False)</dd>
</dl>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../command_list/" class="btn btn-neutral float-left" title="Command list"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/Han-Cao/HarmoniSV/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../../command_list/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
